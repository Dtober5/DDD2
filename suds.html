<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Damien's Demon Detailing — Foam Visual</title>
  <style>
    :root{
      --bg:#000;        /* site base */
      --card:#111;      /* panels/cards if ever needed */
      --accent:#b30000; /* brand red */
      --text:#fff;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Arial,Helvetica,sans-serif;overflow:hidden}

    /* Full‑bleed animated background */
    #foam{position:fixed;inset:0;z-index:-1;display:block;background:#000}

    /* Minimal header so users can navigate back */
    header{display:flex;align-items:center;gap:.75rem;padding:1rem}
    .logo{width:44px;height:44px;border-radius:50%;background:var(--accent)}
    h1{margin:0;color:var(--accent);font-size:1.1rem}
    a.btn{margin-left:auto;background:var(--accent);color:#fff;border:0;border-radius:10px;padding:.5rem .8rem;text-decoration:none}
    a.btn:hover{filter:brightness(1.08)}

    /* Optional hint text (kept subtle) */
    .hint{position:fixed;left:1rem;bottom:1rem;opacity:.6;font-size:.85rem;pointer-events:none}

    /* Reduced motion users get a calmer effect; rest handled in JS */
    @media (prefers-reduced-motion: reduce){ .logo{box-shadow:none} }
  </style>
</head>
<body>
  <canvas id="foam" aria-hidden="true"></canvas>

  <header>
    <div class="logo" aria-label="DDD logo"></div>
    <h1>Foam Visual</h1>
    <a class="btn" href="index.html">← Back to Main</a>
  </header>

  <div class="hint">Drag to swirl · Click/hold to add foam</div>

  <script>
  ;(() => {
    // THEME & LOOK — tuned to blue/white soap‑cannon foam
    const TINT = [167, 200, 255];  // icy blue rim
    const CFG = {
      DENSITY: 1600,     // total bubbles target
      SIZE: 6,           // base bubble radius
      GRAVITY: 0.095,    // drip speed
      SPREAD: 0.12,      // lateral sheet spread
      SWIRL: 0.055,      // subtle curl in the flow
      MOUSE: 0.16,       // pointer influence
      GLOW: 12           // soft additive bloom
    };

    // Respect reduced‑motion: fewer particles and subdued motion
    if (matchMedia('(prefers-reduced-motion: reduce)').matches){
      CFG.DENSITY = 800; CFG.SWIRL = 0.028; CFG.MOUSE = 0.08; CFG.GLOW = 6;
    }

    const dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
    const canvas = document.getElementById('foam');
    const ctx = canvas.getContext('2d');

    let W=0,H=0; function resize(){
      W = Math.floor(innerWidth*dpr); H = Math.floor(innerHeight*dpr);
      canvas.width=W; canvas.height=H; canvas.style.width=innerWidth+'px'; canvas.style.height=innerHeight+'px';
    } resize(); addEventListener('resize', resize);

    // Pointer (no UI panel — minimal interactivity only)
    const pointer = {x: W*0.5, y: H*0.2, vx:0, vy:0, down:false};
    addEventListener('pointermove', e=>{
      const x=e.clientX*dpr, y=e.clientY*dpr; pointer.vx=x-pointer.x; pointer.vy=y-pointer.y; pointer.x=x; pointer.y=y;
    }, {passive:true});
    addEventListener('pointerdown', ()=> pointer.down=true);
    addEventListener('pointerup',   ()=> pointer.down=false);

    // Bubbles
    const bubbles=[];
    class Bubble{
      constructor(spawnTop=false){ this.reset(spawnTop); }
      reset(spawnTop){
        this.r  = 2 + Math.random()*CFG.SIZE;
        this.x  = spawnTop ? (W*0.35 + Math.random()*W*0.3) : Math.random()*W;
        this.y  = spawnTop ? -this.r - Math.random()*30      : Math.random()*H*0.55;
        this.vx = (Math.random()-.5)*0.25;
        this.vy = 0.12 + Math.random()*0.35;
        this.alpha = 0.6 + Math.random()*0.6; // opacity bias per bubble
      }
      step(){
        // Sheet spread (sideways creep like foam sheeting on paint)
        this.vx += Math.sin((this.y*0.0008)+(this.x*0.0005)) * CFG.SPREAD;
        // Gentle curl for organic motion
        this.vx += Math.cos((this.x+this.y)*0.0008) * CFG.SWIRL;
        this.vy += Math.sin((this.x-this.y)*0.0009) * CFG.SWIRL * 0.6;
        // Gravity drip
        this.vy += CFG.GRAVITY*0.001;
        // Pointer swirl (no panel, just subtle influence)
        const dx=this.x-pointer.x, dy=this.y-pointer.y; const r2=dx*dx+dy*dy; const rad= Math.max(90, CFG.SIZE*18);
        if (r2 < rad*rad){ this.vx += (-pointer.vy)*0.02*CFG.MOUSE; this.vy += (pointer.vx)*0.02*CFG.MOUSE; }
        // Integrate + light drag
        this.vx*=0.995; this.vy*=0.997; this.x+=this.vx; this.y+=this.vy;
        // Respawn when leaving frame
        if (this.y - this.r > H+20 || this.x<-40 || this.x>W+40){ this.reset(true); }
      }
      draw(){
        // White core + blue rim → thick wet foam
        const a = 0.06*this.alpha; // global alpha per bubble
        const g = ctx.createRadialGradient(this.x,this.y,this.r*0.2, this.x,this.y,this.r);
        g.addColorStop(0, `rgba(255,255,255,${a*1.5})`);
        g.addColorStop(0.55, `rgba(${TINT[0]},${TINT[1]},${TINT[2]},${a})`);
        g.addColorStop(1, 'rgba(0,0,0,0)');
        ctx.fillStyle=g; ctx.beginPath(); ctx.arc(this.x,this.y,this.r,0,Math.PI*2); ctx.fill();
        // Subtle drip tick
        ctx.strokeStyle = `rgba(255,255,255,${a*0.55})`; ctx.lineWidth = 0.6; ctx.beginPath(); ctx.moveTo(this.x, this.y-this.r*0.2); ctx.lineTo(this.x, this.y+this.r*1.1); ctx.stroke();
      }
    }

    function rebuild(n){ bubbles.length=0; for(let i=0;i<n;i++) bubbles.push(new Bubble(false)); }

    rebuild(CFG.DENSITY);

    // Animation loop — lean and stable
    function frame(){
      // trailing fade for glow
      ctx.globalCompositeOperation='source-over';
      ctx.fillStyle = `rgba(0,0,0,${Math.max(0.08, 0.28 - CFG.GLOW/100)})`;
      ctx.fillRect(0,0,W,H);

      // foam pass (additive bloom)
      ctx.globalCompositeOperation='lighter';
      ctx.shadowBlur = CFG.GLOW; ctx.shadowColor='rgba(255,255,255,0.2)';

      // Click/hold = inject new foam from the cannon band
      if (pointer.down){ for(let i=0;i<14;i++) bubbles.push(new Bubble(true)); }

      // Step & draw
      const cap = CFG.DENSITY; // cap to avoid runaway growth
      if (bubbles.length>cap) bubbles.length = cap;
      for (let i=0;i<bubbles.length;i++){ bubbles[i].step(); bubbles[i].draw(); }

      requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
  })();
  </script>
</body>
</html>
